# simlaunch.yaml

launch:

- arg:
  name: "car_name"
  default: "car_1"
- arg:
  name: "x_pos"
  default: "0.0"
- arg:
  name: "y_pos"
  default: "0.0"
- arg:
  name: "z_pos"
  default: "0.05"
- arg:
  name: "paint"
  default: "Blue"
- arg:
    name: "track"
    default: "world/race_track.world"

# controller config
- group:
  - param:
      from: "$(find ros2_gazebo_sim)/config/control.yaml"

# controller parameters
- param:
    name: "$(arg car_name)/left_front_wheel_velocity_controller/joint"
    value: "$(arg car_name)_left_front_wheel_joint"
- param:
    name: "$(arg car_name)/right_front_wheel_velocity_controller/joint"
    value: "$(arg car_name)_right_front_wheel_joint"
- param:
    name: "$(arg car_name)/left_rear_wheel_velocity_controller/joint"
    value: "$(arg car_name)_left_rear_wheel_joint"
- param:
    name: "$(arg car_name)/right_rear_wheel_velocity_controller/joint"
    value: "$(arg car_name)_right_rear_wheel_joint"
- param:
    name: "$(arg car_name)/left_steering_hinge_position_controller/joint"
    value: "$(arg car_name)_left_steering_hinge_joint"
- param:
    name: "$(arg car_name)/right_steering_hinge_position_controller/joint"
    value: "$(arg car_name)_right_steering_hinge_joint"

# spawn pose
- param:
    name: "$(arg car_name)/init_pose"
    value: "[$(arg x_pos), $(arg y_pos), $(arg z_pos)]"

# robot description
- param:
    name: "$(arg car_name)/robot_description"
    command: "$(find xacro)/xacro --inorder '$(find ros2_gazebo_sim)/urdf/macros.xacro' robot_name:='$(arg car_name)' robot_skin:='$(arg paint)'"

# launch gazebo
- node:
    package: "ros_gz_sim"
    executable: "gz_sim.launch.py"
    name: "gz_sim"
    arguments: ["$(arg track)"]

# spawn robot
- node:
    package: "ros_gz_sim"
    executable: "ros_gz_spawn_model.launch.py"
    name: "ros_gz_spawn_model"
    arguments: [
        "world:=default",
        "file:=$(find ros2_gazebo_sim)/urdf/model.urdf",
        "entity_name:=$(arg car_name)",
        "x:=$(arg x_pos)",
        "y:=$(arg y_pos)",
        "z:=$(arg z_pos)",
        "bridge_name:=ros_gz_bridge",
        "config_file:=$(find ros2_gazebo_sim)/config/topic_config.yaml"
    ]